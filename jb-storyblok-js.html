<script> 
  
  function createStringOfHtmlModules(arrayOfRelevantData) {
    console.log("arrayOfRelevantData", arrayOfRelevantData)
    var stringOfHtmlModules = "";
    
    arrayOfRelevantData.forEach(function(item, index){
      
      switch(item.component) {
        case "h1":
          stringOfHtmlModules += `<div class="module module--h1Module ${item['css_class']}">
                                    <h1 style="text-align: ${item.alignment}" class="h1Module">${item["heading_text"]}</h1>
                                  </div>`;
          break;
        case "h2":
          stringOfHtmlModules += `<div class="module module--h2Module ${item['css_class']}">
                                    <h2 style="text-align: ${item.alignment}" class="h2Module">${item["heading_text"]}</h2>
                                  </div>`;
          break;
        case "paragraph":
          stringOfHtmlModules += `<div class="module module--p1Module ${item['css_class']}">
                                    <p style="text-align: ${item.alignment}" ${item.alignment}" class="p1Module">${item["paragraph_text"]}</p>
                                  </div>`;
          break;
        case "cta_button":
          var ctaTarget = item['open_in_new_window'] ? "_blank" : '';
          stringOfHtmlModules += `<div class="module module--ctaButton ${item['css_class']}">
                                    <a target="${ctaTarget}" href="${item['button_url']}">${item['button_text']}</a>
                                  </div>`;
          break;
        case "image":
          var imageModuleAltText = item.image[0].alt ? item.image[0].alt : "Charles and Colvard jewelry";
          var imageLinkUrl = item['link_url'] ? item['link_url'] : '';
          var pointerEventsStyle  = item['link_url'] ? 'pointer-events: auto' : 'pointer-events: none';
          stringOfHtmlModules +=  `<div class="module module--imageModule ${item['css_class']}">
                                      <a style="${pointerEventsStyle}" href="${imageLinkUrl}">
                                        <img alt="${imageModuleAltText}" class="module module--imageModule" src=${item.image[0].filename} />
                                      </a>
                                    </div>`;
          break;
        case "iframe":
          stringOfHtmlModules +=  `<div class="module module--iframe ${item['css_class']}">
                                    ${item['iframe_code']}
                                  </div>`;
          break;
        case "html":
          stringOfHtmlModules +=  `${item['html_code']}`;
          break;
        case "video_banner":
            let videoBannercssClass;
            let videoBannerVideoSource;
            let videoBannerposter;
            let videoBannerFallbackImageOnScreenResize;
            let viewportWidth = window.innerWidth;

            if (viewportWidth > 900) {
              videoBannercssClass = "desktopVideoIframe";
              videoBannerVideoSource = item['desktop_vimeo_source'];
              videoBannerposter = item['desktop_banner_first_frame_image'][0].filename;
              videoBannerFallbackImageOnScreenResize = item['mobile_banner_first_frame_image'][0].filename;
            }

            else {
              videoBannercssClass = "mobileVideoIframe";
              videoBannerVideoSource = item['mobile_vimeo_source'];
              videoBannerposter = item['mobile_banner_first_frame_image'][0].filename;
              videoBannerFallbackImageOnScreenResize = item['desktop_banner_first_frame_image'][0].filename;
            }

          stringOfHtmlModules +=  `<div style="background-image: url(${videoBannerFallbackImageOnScreenResize})" class="module--videoBanner ${item['css_class']}">
                                      <a href=${item['link_url']}>
                                        <div style="background-image: url(${item['desktop_banner_text_image'][0].filename})" class="videoBannerTextImage videoBannerTextImage--desktop">
                                        </div>
                                      </a>
                                      <a href=${item['link_url']}>
                                        <div style="background-image: url(${item['mobile_banner_text_image'][0].filename})" class="videoBannerTextImage videoBannerTextImage--mobile">
                                        </div>
                                      </a>
                                      <video  id="videoElement" 
                                              src=${videoBannerVideoSource}
                                              poster=${videoBannerposter}
                                              class=${videoBannercssClass}
                                              style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;" playsinline loop autoplay muted>
                                      </video>
                                  </div>`;
        break;
        case "static_image_banner":
          stringOfHtmlModules +=  `<div style="background-image: url(${item['desktop_banner_background_image'][0].filename})" class="module--staticImageBanner module--staticImageBanner--desktop ${item['css_class']}">
                                      <a href=${item['link_url']}>
                                        <div style="background-image: url(${item['desktop_banner_text_image'][0].filename})" class="videoBannerTextImage ">
                                        </div>
                                      </a>
                                  </div>
                                  <div style="background-image: url(${item['mobile_banner_background_image'][0].filename})" class="module--staticImageBanner module--staticImageBanner--mobile ${item['css_class']}">
                                      <a href=${item['link_url']}>
                                        <div style="background-image: url(${item['mobile_banner_text_image'][0].filename})" class="videoBannerTextImage ">
                                        </div>
                                      </a>
                                  </div>`;
        break;                         
        case "category_banner":
          let catBannertextColor = item["writing_color"] == "dark" ? "darkText" : "lightText";
          let hideCategoruyBannerSubHeadingClass = !item["banner_subHeading"] ? 'jb-displayNone' : "";
          let hideCategoryButtonClass = !item['button_url'] ? 'jb-displayNone' : "";

          stringOfHtmlModules +=  `<div style="background-image: url(${item['banner_image'][0]["filename"]})" class="module module--categoryBannerModule ${item['css_class']} ${catBannertextColor}">
                                      <div class="jb-overlay"></div>
                                      <div class="categoryBannerModuleContentWrap">
                                      <h1 class="categoryBannerModule__heading">${item['banner_heading']}</h1>
                                      <p class="categoryBannerModule__subbHeading ${hideCategoruyBannerSubHeadingClass}">${item['banner_subHeading']}</p>
                                      <div class="buttonWrap ${hideCategoryButtonClass}">
                                        <a class="button categoryBannerModule__button" href=${item['button_url']}>${item['button_text']} > </a>
                                      </div>
                                    </div>
                                  </div>`;
        break;
        case "grid":
          let numberOfColumns = item.column.length;
          stringOfHtmlModules += `<div class="module module--columnsModule ${item['css_class']} columns${numberOfColumns}">`;
          stringOfHtmlModules +=    createStringOfHtmlModules(item.column);
          stringOfHtmlModules += `</div>`;
          break;
        case "column_content":
          stringOfHtmlModules += `<div class="module module--columnContentModule ${item['css_class']}">`;
          stringOfHtmlModules +=    createStringOfHtmlModules(item.block);
          stringOfHtmlModules += `</div>`;
          break;
        default:
          stringOfHtmlModules += `<div class="module module--error">ERROR: ${item["component"]} does not exist</div>`;
      }
    })
    
    return stringOfHtmlModules;


   





  }

</script>